<?xml version="1.0"?>
<sdf version="1.6">
  <model name="disaster_relief_drone">
    <static>false</static>

    <!-- ───────── 1. Central Hex Body ───────── -->
    <link name="base_link">
      <pose>0 0 0 0 0 0</pose>
      <inertial>
        <!-- I-4: mass ランダム化に備えコメントで基準値を明記 -->
        <mass>0.95</mass>  <!-- baseline mass [kg] -->
        <inertia>
          <ixx>0.018</ixx><iyy>0.018</iyy><izz>0.035</izz>
          <ixy>0</ixy><ixz>0</ixz><iyz>0</iyz>
        </inertia>
      </inertial>

      <visual name="body_vis">
        <geometry>
          <mesh><uri>meshes/hex_body.dae</uri></mesh>
        </geometry>
        <material><ambient>0.3 0.3 0.3 1</ambient></material>
      </visual>
      <collision name="body_col">
        <geometry>
          <mesh><uri>meshes/hex_body_convex.stl</uri></mesh>
        </geometry>
      </collision>
    </link>

    <!-- ───────── 2. Outer Quad Rotors (m0-m3) ───────── -->
    <!-- 例として rotor0 のみ全文。1-3 も filename を同様に変更 -->
    <link name="rotor0_link">
      <pose>0.17 0.17 0.02 0 0 0</pose>
      <inertial><mass>0.06</mass></inertial>
      <visual name="rotor0_vis">
        <geometry><cylinder><radius>0.07</radius><length>0.02</length></cylinder></geometry>
      </visual>
    </link>
    <joint name="rotor0_joint" type="fixed">
      <parent>base_link</parent>
      <child>rotor0_link</child>
    </joint>
    <plugin name="rotor0_motor" filename="libgz_motor_model.so">
      <joint_name>rotor0_joint</joint_name>
      <turning_direction>cw</turning_direction>
      <motor_number>0</motor_number>
      <robot_namespace>drone1</robot_namespace>
      <topic>motor_speed</topic>
    </plugin>

    <!-- rotor1, rotor2, rotor3 … (filename 変更のみで同一) -->

    <!-- ───────── 3. Inner Tiltable Fans (m4-m5) ───────── -->
    <!-- fan1 (モーター用 plugin filename 変更) -->
    <link name="fan1_link">
      <pose>0.11 0.11 -0.11 0 0 0</pose>
      <inertial><mass>0.08</mass></inertial>
      <visual name="fan1_vis">
        <geometry><cylinder><radius>0.06</radius><length>0.02</length></cylinder></geometry>
      </visual>
    </link>

    <joint name="fan1_tilt_joint" type="revolute">
      <parent>base_link</parent>
      <child>fan1_link</child>
      <axis>
        <xyz>0 1 0</xyz>
        <limit lower="-0.5236" upper="0.5236" effort="5" velocity="2.0"/>
      </axis>
    </joint>

    <plugin name="fan1_motor" filename="libgz_motor_model.so">
      <joint_name>fan1_tilt_joint</joint_name>
      <turning_direction>ccw</turning_direction>
      <motor_number>4</motor_number>
      <robot_namespace>drone1</robot_namespace>
      <topic>motor_speed</topic>
    </plugin>

    <plugin name="fan1_servo" filename="libignition-gazebo-joint-controller-system.so">
      <joint_name>fan1_tilt_joint</joint_name>
      <topic>/servo/fan1_tilt</topic>
    </plugin>

    <!-- fan2 定義も motor plugin filename を libgz_motor_model.so に変更 -->

  </model>
</sdf>
